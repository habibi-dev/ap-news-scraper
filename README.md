# News Scraper, Translator and Publisher

این پروژه یک سیستم کامل برای خراش داده‌های خبری، ترجمه و انتشار اخبار در کانال تلگرام است.

## ویژگی‌ها

- خراش داده‌های خبری از منابع متعدد خبری جهانی
- ذخیره‌سازی اخبار در پایگاه داده SQLite
- بررسی و فیلتر کردن اخبار با استفاده از Gemini AI
- استخراج محتوای کامل خبر و تصاویر
- ترجمه اخبار با استفاده از Gemini AI
- انتشار اخبار ترجمه شده در کانال تلگرام
- مدیریت وضعیت‌های مختلف خبر (در انتظار بررسی، در انتظار ترجمه، ترجمه شده، منتشر شده)

## پیش‌نیازها

- Node.js (نسخه 14 یا بالاتر)
- کلید API جمنای
- توکن ربات تلگرام

## نصب

1. کلون کردن مخزن
```bash
git clone https://github.com/habibi-dev/ap-news-scraper.git
cd ap-news-scraper
```

2. نصب وابستگی‌ها
```bash
npm install
```

3. تنظیم پیکربندی در فایل `config.js`
    - وارد کردن کلید API جمنای
    - وارد کردن توکن ربات تلگرام و شناسه کانال
    - تنظیم پرامپت‌های ترجمه و بررسی

## نحوه استفاده

### خراش داده‌های خبری
```bash
npm run read
# یا برای منبع خاص
node index.js scrape bbc
```

### پردازش اخبار در انتظار بررسی
```bash
npm run pending
```

### ترجمه اخبار
```bash
npm run translate
```

### انتشار اخبار ترجمه شده
```bash
npm run publish
```

## ساختار پروژه

```
/project
├── index.js                  # فایل اصلی برای اجرای برنامه
├── config.js                 # تنظیمات برنامه
├── package.json              # وابستگی‌های پروژه
├── /services
│   ├── scraper.js            # سرویس خراش‌گر وب
│   ├── newsService.js        # سرویس مدیریت خبر
│   ├── telegram.js           # سرویس ارسال به تلگرام
├── /db
│   ├── newsDatabase.js       # عملیات پایگاه داده
├── /utils
│   ├── helpers.js            # توابع کمکی مثل delay
├── /api
│   ├── geminiApi.js          # ارتباط با API جمنای
```

## فرایند کلی

1. **خراش داده**: اخبار از منابع مختلف جمع‌آوری و در پایگاه داده ذخیره می‌شوند.
2. **بررسی**: عناوین خبری به جمنای ارسال می‌شوند تا مناسب بودن آنها برای ترجمه بررسی شود.
3. **استخراج محتوا**: محتوای کامل خبرهای تأیید شده استخراج می‌شود.
4. **ترجمه**: محتوای کامل خبر به جمنای ارسال می‌شود تا ترجمه شود.
5. **انتشار**: اخبار ترجمه شده در کانال تلگرام منتشر می‌شوند.

## نکات

- در فایل `config.js` می‌توانید انتخاب‌گرهای CSS را برای منابع مختلف خبری تنظیم کنید.
- پرامپت‌های جمنای باید به گونه‌ای تنظیم شوند که خروجی JSON با فرمت مناسب تولید کنند.
- برخی سایت‌های خبری دارای محافظت CloudFlare هستند که ممکن است نیاز به تنظیمات بیشتری داشته باشند.